<?xml version="1.0" encoding="UTF-8" ?>
<!--
  ~ Copyright (c) 2016 杭州端点网络科技有限公司, Code generated by terminus code gen
  -->
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >

<mapper namespace="AllinpayTrans">
    <resultMap id="AllinpayTransMap" type="AllinpayTrans">
        <id column="id" property="id"/>
        <result column="trans_code_msg" property="transCodeMsg"/>
        <result column="trans_date" property="transDate"/>
        <result column="seller_account" property="sellerAccount"/>
        <result column="trade_at" property="tradeAt"/>
        <result column="trans_out_order_no" property="transOutOrderNo"/>
        <result column="trade_no" property="tradeNo"/>
        <result column="total_fee" property="totalFee"/>
        <result column="service_fee" property="serviceFee"/>
        <result column="service_fee_ratio" property="serviceFeeRatio"/>
        <result column="settlement_fee" property="settlementFee"/>
        <result column="currency" property="currency"/>
        <result column="order_origin_fee" property="orderOriginFee"/>
        <result column="memo" property="memo"/>
        <result column="created_at" property="createdAt"/>
        <result column="updated_at" property="updatedAt"/>
        
    </resultMap>

    <sql id="tb">
        vega_allinpay_trans
    </sql>

    <sql id="cols_all">
        id, <include refid="cols_exclude_id" />
    </sql>

    <sql id="cols_exclude_id">
        trans_code_msg, trans_date, seller_account, trade_at, trans_out_order_no, trade_no, total_fee, service_fee, service_fee_ratio, settlement_fee, currency, order_origin_fee, memo, created_at, updated_at
    </sql>

    <sql id="vals">
        #{transCodeMsg}, #{transDate}, #{sellerAccount}, #{tradeAt}, #{transOutOrderNo}, #{tradeNo}, #{totalFee}, #{serviceFee}, #{serviceFeeRatio}, #{settlementFee}, #{currency}, #{orderOriginFee}, #{memo}, now(), now()
    </sql>

    <sql id="queryCondition">
        where 1 = 1
        
        <if test="transCodeMsg != null">and `trans_code_msg` = #{transCodeMsg}</if>
        
        <if test="transDate != null">and `trans_date` = #{transDate}</if>
        
        <if test="sellerAccount != null">and `seller_account` = #{sellerAccount}</if>
        
        <if test="tradeAt != null">and `trade_at` = #{tradeAt}</if>
        
        <if test="transOutOrderNo != null">and `trans_out_order_no` = #{transOutOrderNo}</if>
        
        <if test="tradeNo != null">and `trade_no` = #{tradeNo}</if>
        
        <if test="totalFee != null">and `total_fee` = #{totalFee}</if>
        
        <if test="serviceFee != null">and `service_fee` = #{serviceFee}</if>
        
        <if test="serviceFeeRatio != null">and `service_fee_ratio` = #{serviceFeeRatio}</if>
        
        <if test="settlementFee != null">and `settlement_fee` = #{settlementFee}</if>
        
        <if test="currency != null">and `currency` = #{currency}</if>
        
        <if test="orderOriginFee != null">and `order_origin_fee` = #{orderOriginFee}</if>
        
        <if test="memo != null">and `memo` = #{memo}</if>
        
        <if test="createdAt != null">and `created_at` = #{createdAt}</if>
        
        <if test="updatedAt != null">and `updated_at` = #{updatedAt}</if>
        
        <if test="startAt != null">and created_at &gt; #{startAt}</if>
        <if test="endAt != null">and created_at &lt; #{endAt}</if>
    </sql>

    <sql id="order">
        order by id desc
    </sql>

    <insert id="create" parameterType="AllinpayTrans" keyProperty="id" useGeneratedKeys="true">
        INSERT INTO
        <include refid="tb" />
        (<include refid="cols_exclude_id" />)
        VALUES
        (<include refid="vals" />)
    </insert>

    <select id="findById" parameterType="long" resultMap="AllinpayTransMap" >
        SELECT <include refid="cols_all" />
        FROM <include refid="tb" />
        WHERE id = #{id}
    </select>

    <select id="findByTradeNo" parameterType="string" resultMap="AllinpayTransMap" >
        SELECT <include refid="cols_all" />
        FROM <include refid="tb" />
        WHERE trade_no = #{tradeNo}
    </select>



   <select id="findByIds" parameterType="list" resultMap="AllinpayTransMap">
        select id, <include refid="cols_exclude_id"/>
        from <include refid="tb"/>
        where id in
        <foreach collection="list" open="(" separator="," close=")"
                 item="item">
            #{item}
        </foreach>
        <include refid="order" />
    </select>

    <update id="update" parameterType="AllinpayTrans">
        UPDATE
        <include refid="tb"/>
        <set>
            <if test="transCodeMsg != null">trans_code_msg = #{transCodeMsg},</if>
            <if test="transDate != null">trans_date = #{transDate},</if>
            <if test="sellerAccount != null">seller_account = #{sellerAccount},</if>
            <if test="tradeAt != null">trade_at = #{tradeAt},</if>
            <if test="transOutOrderNo != null">trans_out_order_no = #{transOutOrderNo},</if>
            <if test="tradeNo != null">trade_no = #{tradeNo},</if>
            <if test="totalFee != null">total_fee = #{totalFee},</if>
            <if test="serviceFee != null">service_fee = #{serviceFee},</if>
            <if test="serviceFeeRatio != null">service_fee_ratio = #{serviceFeeRatio},</if>
            <if test="settlementFee != null">settlement_fee = #{settlementFee},</if>
            <if test="currency != null">currency = #{currency},</if>
            <if test="orderOriginFee != null">order_origin_fee = #{orderOriginFee},</if>
            <if test="memo != null">memo = #{memo},</if>
            
            
            
            updated_at=now()
        </set>
        WHERE id = #{id}
    </update>

    <delete id="delete" parameterType="long">
        DELETE FROM <include refid="tb"/>
        WHERE id = #{id}
    </delete>

    <select id="paging" parameterType="list" resultMap="AllinpayTransMap">
        select id, <include refid="cols_exclude_id"/>
        from <include refid="tb"/>
        <include refid="queryCondition"/>
        order by id desc limit #{offset},#{limit}
    </select>

    <select id="count" parameterType="list" resultType="long">
        select count(1)
        from <include refid="tb"/>
        <include refid="queryCondition"/>
    </select>

</mapper>